#include<GL/glut.h>
#include<math.h>
#include<stdio.h>
int left=0,right=300,bottom=30,top=200;
float x,y;
int i,j,move=0,flag=-1;
int rotate_y=0;
void myinit()
{
   /* glClearColor(1.0,1.0,1.0,1.0);
    glColor3f(0.0,0.97265625,0.92578125);
     glMatrixMode(GL_PROJECTION);
     glLoadIdentity();
    gluOrtho2D(left,right,bottom,top);
    glMatrixMode(GL_MODELVIEW);*/

}
void rash_rectangle(int x,int y,int l,int b){
     glBegin(GL_POLYGON);
        glVertex2f(x,y);
        glVertex2f(x+b,y);
        glVertex2f(x+b,y+l);
        glVertex2f(x,y+l); 
     glEnd();   
}
void checking(){
        //first building from  left
        int i,b,l;
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(0,70);
        glVertex2f(0,160);
        glVertex2f(40,160);
        glVertex2f(40,70); 
     glEnd();
     glBegin(GL_TRIANGLES);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(20,170);
        glVertex2f(0,160);
        glVertex2f(40,160); 
     glEnd();
     glColor3f(1.0,1.0,1.0);
     for(i=80;i<=140;){
        rash_rectangle(5,i,10,10);
        i+=20;
     }
     glColor3f(1.0,1.0,1.0);
     for(i=80;i<=140;){
        rash_rectangle(20,i,10,10);
        i+=20;
     }
     glBegin(GL_LINE_LOOP);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(0,70);
        glVertex2f(0,160);
        glVertex2f(40,160);
        glVertex2f(40,70); 
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(20,170);
        glVertex2f(0,160);
        glVertex2f(40,160); 
     glEnd(); 
     //second building from left
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(60,70);
        glVertex2f(60,140);
        glVertex2f(41,140);
        glVertex2f(41,70); 
     glEnd();
     glColor3f(1.0,1.0,1.0);
     for(i=75;i<=120;){
     
    
        rash_rectangle(43,i,10,15);
         //glColor3f(0.48046875,0.609375,0.6171875);
        i+=15;
     }
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(60,140);
        glVertex2f(41,140);
        glVertex2f(50,150); 
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(60,140);
        glVertex2f(60,70);
        glVertex2f(41,70);
        glVertex2f(41,140); 
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(60,140);
        glVertex2f(41,140);
        glVertex2f(50,150); 
     glEnd();
     //third building
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(61,70);
        glVertex2f(61,133);
        glVertex2f(90,133);
        glVertex2f(90,70); 
     glEnd();
     glColor3f(1.0,1.0,1.0);
     for(i=73;i<=133;){
        rash_rectangle(63,i,6,5);
        i+=8;
     }
     for(i=73;i<=133;){
        rash_rectangle(70,i,6,5);
        i+=8;
     }
     for(i=73;i<=133;){
        rash_rectangle(77,i,6,5);
        i+=8;
     }
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(61,133);
        glVertex2f(90,133);
        glVertex2f(90,135);
        glVertex2f(61,135);  
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(61,70);
        glVertex2f(61,133);
        glVertex2f(90,133);
        glVertex2f(90,70); 
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(61,133);
        glVertex2f(90,133);
        glVertex2f(90,135);
        glVertex2f(61,135);  
     glEnd();
     //4th building
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(120,70);
        glVertex2f(120,155);
        glVertex2f(91,155);
        glVertex2f(91,70); 
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(120,70);
        glVertex2f(120,105);
        glVertex2f(91,105);
        glVertex2f(91,70); 
     glEnd();
     glColor3f(1.0,1.0,1.0);
     for(i=72;i<=154;){
        rash_rectangle(92,i,82,27);
        i+=84;
     }
     //5th building
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(121,70);
        glVertex2f(121,135);
        glVertex2f(170,135);
        glVertex2f(170,70); 
     glEnd();
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(126,170);
        glVertex2f(126,135);
        glVertex2f(165,135);
        glVertex2f(165,170); 
     glEnd();
     glColor3f(1.0,1.0,1.0);
     for(i=71;i<130;){
        rash_rectangle(122,i,8,14);
        i+=9;
     }
     for(i=71;i<130;){
        rash_rectangle(139,i,8,26);
        i+=9;
     }
     for(i=136;i<165;){
        rash_rectangle(127,i,7,36);
        i+=8;
       } 
     //6th building
     glBegin(GL_POLYGON);
        glColor3f(1.0,1.0,1.0);
        glVertex2f(181,70);
        glVertex2f(181,140);
        glVertex2f(210,140);
        glVertex2f(210,70); 
     glEnd();
     glColor3f(1.0,1.0,1.0);
     for(i=71;i<135;){
        rash_rectangle(182,i,10,14);
        i+=11;
     }
     for(i=71;i<135;){
        rash_rectangle(197,i,10,12);
        i+=11;
     }
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(186,145);
        glVertex2f(186,140);
        glVertex2f(205,140);
        glVertex2f(205,145); 
     glEnd();
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(191,145);
        glVertex2f(191,180);
        glVertex2f(200,180);
        glVertex2f(200,145); 
     glEnd();
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(195,200);
        glVertex2f(191,180);
        glVertex2f(200,180); 
     glEnd();
     //7th building
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(245,70);
        glVertex2f(245,150);
        glVertex2f(215,150);
        glVertex2f(215,70);
        /*for(i=71;i<=145;){
                rash_rectangle(216,i,9,28);
                i+=11;
        }*/ 
     glEnd();
     //8th building
     glBegin(GL_POLYGON);
        glColor3f(0.48046875,0.609375,0.6171875);
        glVertex2f(250,70);
        glVertex2f(250,180);
        glVertex2f(290,180);
        glVertex2f(290,70); 
     glEnd();
     glColor3f(1.0,1.0,1.0);
     for(i=71;i<=176;){
        rash_rectangle(252,i,10,16);
        i+=12;
     }
     for(i=71;i<=176;){
        rash_rectangle(271,i,10,16);
        i+=12;
     }
     
}
void back_scene(){
        //first building from  left
        int i,b,l;
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(0,70);
        glVertex2f(0,160);
        glVertex2f(40,160);
        glVertex2f(40,70); 
     glEnd();
     glBegin(GL_TRIANGLES);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(20,170);
        glVertex2f(0,160);
        glVertex2f(40,160); 
     glEnd();
     glColor3f(1.0,1.0,0.0);
     for(i=80;i<=140;){
        rash_rectangle(5,i,10,10);
        i+=20;
     }
     glColor3f(1.0,1.0,0.0);
     for(i=80;i<=140;){
        rash_rectangle(20,i,10,10);
        i+=20;
     }
     glBegin(GL_LINE_LOOP);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(0,70);
        glVertex2f(0,160);
        glVertex2f(40,160);
        glVertex2f(40,70); 
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(20,170);
        glVertex2f(0,160);
        glVertex2f(40,160); 
     glEnd(); 
     //second building from left
     glBegin(GL_POLYGON);
        glColor3f(1.0,0.0,0.0);
        glVertex2f(60,70);
        glVertex2f(60,140);
        glVertex2f(41,140);
        glVertex2f(41,70); 
     glEnd();
     glColor3f(1.0,1.0,0.0);
     for(i=75;i<=120;){
     
    
        rash_rectangle(43,i,10,15);
         //glColor3f(0.859,0.875,0.8320);
        i+=15;
     }
     glBegin(GL_POLYGON);
        glColor3f(1.0,0.0,0.0);
        glVertex2f(60,140);
        glVertex2f(41,140);
        glVertex2f(50,150); 
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(1.0,0.0,0.0);
        glVertex2f(60,140);
        glVertex2f(60,70);
        glVertex2f(41,70);
        glVertex2f(41,140); 
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(1.0,0.0,0.0);
        glVertex2f(60,140);
        glVertex2f(41,140);
        glVertex2f(50,150); 
     glEnd();
     //third building
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(61,70);
        glVertex2f(61,133);
        glVertex2f(90,133);
        glVertex2f(90,70); 
     glEnd();
     glColor3f(1.0,1.0,0.0);
     for(i=73;i<=133;){
        rash_rectangle(63,i,6,5);
        i+=8;
     }
     for(i=73;i<=133;){
        rash_rectangle(70,i,6,5);
        i+=8;
     }
     for(i=73;i<=133;){
        rash_rectangle(77,i,6,5);
        i+=8;
     }
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(61,133);
        glVertex2f(90,133);
        glVertex2f(90,135);
        glVertex2f(61,135);  
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(61,70);
        glVertex2f(61,133);
        glVertex2f(90,133);
        glVertex2f(90,70); 
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(61,133);
        glVertex2f(90,133);
        glVertex2f(90,135);
        glVertex2f(61,135);  
     glEnd();
     //4th building
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(120,70);
        glVertex2f(120,155);
        glVertex2f(91,155);
        glVertex2f(91,70); 
     glEnd();
     glBegin(GL_LINE_LOOP);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(120,70);
        glVertex2f(120,105);
        glVertex2f(91,105);
        glVertex2f(91,70); 
     glEnd();
     glColor3f(1.0,1.0,0.0);
     for(i=72;i<=154;){
        rash_rectangle(92,i,82,27);
        i+=84;
     }
     //5th building
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(121,70);
        glVertex2f(121,135);
        glVertex2f(170,135);
        glVertex2f(170,70); 
     glEnd();
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(126,170);
        glVertex2f(126,135);
        glVertex2f(165,135);
        glVertex2f(165,170); 
     glEnd();
     glColor3f(1.0,1.0,0.0);
     for(i=71;i<130;){
        rash_rectangle(122,i,8,14);
        i+=9;
     }
     for(i=71;i<130;){
        rash_rectangle(139,i,8,26);
        i+=9;
     }
     for(i=136;i<165;){
        rash_rectangle(127,i,7,36);
        i+=8;
       } 
     //6th building
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(181,70);
        glVertex2f(181,140);
        glVertex2f(210,140);
        glVertex2f(210,70); 
     glEnd();
     glColor3f(1.0,1.0,0.0);
     for(i=71;i<135;){
        rash_rectangle(182,i,10,14);
        i+=11;
     }
     for(i=71;i<135;){
        rash_rectangle(197,i,10,12);
        i+=11;
     }
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(186,145);
        glVertex2f(186,140);
        glVertex2f(205,140);
        glVertex2f(205,145); 
     glEnd();
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(191,145);
        glVertex2f(191,180);
        glVertex2f(200,180);
        glVertex2f(200,145); 
     glEnd();
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(195,200);
        glVertex2f(191,180);
        glVertex2f(200,180); 
     glEnd();
     //7th building
     glBegin(GL_POLYGON);
        glColor3f(1.0,1.0,0.0);
        glVertex2f(245,70);
        glVertex2f(245,150);
        glVertex2f(215,150);
        glVertex2f(215,70);
        /*for(i=71;i<=145;){
                rash_rectangle(216,i,9,28);
                i+=11;
        }*/ 
     glEnd();
     //8th building
     glBegin(GL_POLYGON);
        glColor3f(0.0,1.0,0.0);
        glVertex2f(250,70);
        glVertex2f(250,180);
        glVertex2f(290,180);
        glVertex2f(290,70); 
     glEnd();
     glColor3f(1.0,1.0,0.0);
     for(i=71;i<=176;){
        rash_rectangle(252,i,10,16);
        i+=12;
     }
     for(i=71;i<=176;){
        rash_rectangle(271,i,10,16);
        i+=12;
     }
     
}
void my_road(){
      int i=0;
      //road
      //black road
      glBegin(GL_POLYGON);
        glColor3f(0.0,0.0,0.0);
        glVertex2f(left,20);
        glVertex2f(right,20);
        glVertex2f(right,71);
        glVertex2f(left,71); 
     glEnd();
      glBegin(GL_LINE_LOOP);
        glColor3f(0.0,0.0,0.0);
        glVertex2f(left,20);
        glVertex2f(right,20);
        glVertex2f(right,71);
        glVertex2f(left,71); 
     glEnd(); 
     //edge lines 1
      glBegin(GL_POLYGON);
        glColor3f(1.0,1.0,1.0);
        glVertex2f(left,21);
        glVertex2f(right,21);
        glVertex2f(right,22);
        glVertex2f(left,22); 
     glEnd();
      glBegin(GL_LINE_LOOP);
        glColor3f(1.0,1.0,0.0);
        glVertex2f(left,21);
        glVertex2f(right,21);
        glVertex2f(right,22);
        glVertex2f(left,22); 
     glEnd(); 
     //edge lines 2
      glBegin(GL_POLYGON);
        glColor3f(1.0,1.0,1.0);
        glVertex2f(left,70);
        glVertex2f(right,70);
        glVertex2f(right,69);
        glVertex2f(left,69); 
     glEnd();
      glBegin(GL_LINE_LOOP);
        glColor3f(1.0,1.0,0.0);
        glVertex2f(left,70);
        glVertex2f(right,70);
        glVertex2f(right,69);
        glVertex2f(left,69); 
     glEnd();
     //middle line
     for(i=left-5;i<=right;){
        glBegin(GL_POLYGON);
                glColor3f(1.0,1.0,1.0);
                glVertex2f(i,45);
                glVertex2f(i+10,45);
                glVertex2f(i+10,47);
                glVertex2f(i,47); 
        glEnd();
        i+=15;
     }
}

void circleBres(int xc, int yc, int r)
{
    for(i=0;i<=360;i++)
    {
        x=xc+r*sin(i);
        y=yc+r*cos(i);
        printf("x=%f y=%f\n",x,y);
        glBegin(GL_LINES);
        glVertex2f(xc,yc);
        glVertex2f(x,y);
        glEnd();
    }
}

void mycar()
{
     //whole body
     glBegin(GL_POLYGON);
        glColor3f(1.0,0.0,0.0);
        glVertex2f(25,40);
        glVertex2f(25,30);
        glVertex2f(110,30);
        glVertex2f(110,35);
        glVertex2f(90,45);
        glVertex2f(40,45); 
     glEnd();
     glBegin(GL_POLYGON);
        glColor3f(1.0,0.0,0.0);
        glVertex2f(40,45);
        glVertex2f(48,60);
        glVertex2f(80,60);
        glVertex2f(90,45); 
     glEnd(); 
     glBegin(GL_LINE_LOOP);
        glColor3f(0.0,0.0,0.0);
        glVertex2f(25,30);
        glVertex2f(25,40);
        glVertex2f(40,45);
        glVertex2f(48,60);
        glVertex2f(80,60);
        glVertex2f(90,45);
        glVertex2f(110,35);
        glVertex2f(110,30);
     glEnd();
     //windows
      glBegin(GL_POLYGON);
        glColor3f(0.0,0.0,1.0);
        glVertex2f(43,45);
        glVertex2f(65,45);
        glVertex2f(65,58);
        glVertex2f(50,58); 
     glEnd();
      glBegin(GL_LINE_LOOP);
        glColor3f(0.0,0.0,0.0);
        glVertex2f(43,45);
        glVertex2f(65,45);
        glVertex2f(65,58);
        glVertex2f(50,58); 
     glEnd();
     glBegin(GL_POLYGON);
        glColor3f(0.0,0.0,1.0);
        glVertex2f(67,45);
        glVertex2f(89,45);
        glVertex2f(79,58);
        glVertex2f(67,58); 
     glEnd();
      glBegin(GL_LINE_LOOP);
        glColor3f(0.0,0.0,0.0);
        glVertex2f(67,45);
        glVertex2f(89,45);
        glVertex2f(79,58);
        glVertex2f(67,58); 
     glEnd();
     //back bumper
     glBegin(GL_POLYGON);
        glColor3f(0.601562,0.625,0.5546875);
        glVertex2f(24,30);
        glVertex2f(27,30);
        glVertex2f(27,32);
        glVertex2f(24,32); 
     glEnd();
      glBegin(GL_LINE_LOOP);
        glColor3f(0.0,0.0,0.0);
        glVertex2f(24,30);
        glVertex2f(27,30);
        glVertex2f(27,32);
        glVertex2f(24,32); 
     glEnd();
     //back lamps
     glBegin(GL_POLYGON);
        glColor3f(0.97265625,0.875,0.0);
        glVertex2f(25,40);
        glVertex2f(27,40);
        glVertex2f(27,35);
        glVertex2f(25,35); 
     glEnd();
      glBegin(GL_LINE_LOOP);
        glColor3f(0.0,0.0,0.0);
        glVertex2f(25,40);
        glVertex2f(27,40);
        glVertex2f(27,35);
        glVertex2f(25,35); 
     glEnd();
     //front bumper
     glBegin(GL_POLYGON);
        glColor3f(0.601562,0.625,0.5546875);
        glVertex2f(108,30);
        glVertex2f(111,30);
        glVertex2f(111,32);
        glVertex2f(108,32); 
     glEnd();
      glBegin(GL_LINE_LOOP);
        glColor3f(0.0,0.0,0.0);
        glVertex2f(108,30);
        glVertex2f(111,30);
        glVertex2f(111,32);
        glVertex2f(108,32); 
     glEnd();
     //front lamps
        glColor3f(0.97265625,0.875,0.0);
        rash_rectangle(108,33,2,2);
      glBegin(GL_LINE_LOOP);
        glColor3f(0.0,0.0,0.0);
        glVertex2f(110,35);
        glVertex2f(108,35);
        glVertex2f(108,33);
        glVertex2f(110,33); 
     glEnd();
     glColor3f(0.0,0.0,0.0);
     circleBres(45,30,7);
     glColor3f(0.0,0.0,0.0);
     circleBres(90,30,7);
     glColor3f(0.26171875,0.265625,0.24609375);
     circleBres(45,30,6);
     glColor3f(0.26171875,0.265625,0.24609375);
     circleBres(90,30,6);
     glColor3f(0.601562,0.625,0.5546875);
     circleBres(45,30,3);
     glColor3f(0.601562,0.625,0.5546875);
     circleBres(90,30,3);
     
}
void keyboards(unsigned char k,int x,int y)
{
            if(k=='x')
            {
                rotate_y=1;
            }
            if(k=='X') 
            {
                rotate_y=0;
            }
            glutPostRedisplay();
}
void mydisplay(){
        glClearColor(1.0,1.0,1.0,1.0);
        glColor3f(0.0,0.97265625,0.92578125);
        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        gluOrtho2D(left,right,bottom,top);
        glMatrixMode(GL_MODELVIEW);
        glClear(GL_COLOR_BUFFER_BIT);
        glLoadIdentity();
        if(flag==-1)
        glColor3f(0.0,0.97265625,0.92578125);
        else
        glColor3f(0.0,0.0,0.0);
        glBegin(GL_POLYGON);
        glVertex2f(left,top);
        glVertex2f(right,top);
        glVertex2f(right,bottom);
        glVertex2f(left,bottom); 
        glEnd();
        glPushMatrix();
        glTranslatef(50,0,0);
        checking();
        glTranslatef(-50,0,0); 
        glPopMatrix();
        back_scene();
        glPushMatrix();
        glTranslatef(350,0,0);
        checking();
        glTranslatef(-350,0,0);
        glPopMatrix();
        glPushMatrix();
        glTranslatef(300,0,0);
        back_scene();
        glTranslatef(-300,0,0);
        glPopMatrix();
        my_road();
        glPushMatrix();
        glTranslatef(move,0,0);
        mycar();
        glTranslatef(-move,0,0);
        if(move<=right)
        move+=rotate_y;
        else
        move=-100;
        if(move==250 && move<600){
                left+=200;
                right+=300;
               // gluOrtho2D(left,right,bottom,top);
        }
        if(move==600)
        {
               left=0;
               right=300;
               //gluOrtho2D(left,right,bottom,top);
               flag*=-1;
        }
        
        glPopMatrix();
        //glScalef(1,scale_x,1);
	 
	 glPushMatrix();
        glBegin(GL_POLYGON);
        glColor3f(0.601562,0.625,0.5546875);
        glVertex2f(left,20);
        glVertex2f(right,20);
        glVertex2f(right,bottom);
        glVertex2f(left,bottom); 
        glEnd();
        glutSwapBuffers();
         glutPostRedisplay();
        glFlush();
        
}
int main(int argc,char**argv)
{
    glutInit(&argc,argv);
    glutInitDisplayMode(GLUT_DOUBLE|GLUT_RGB);
    glutInitWindowSize(500,500);
    glutInitWindowPosition(0,0);
    glutCreateWindow("My Car");
    //glutReshapeFunc(myreshape);
    glutKeyboardFunc(keyboards);
    myinit();
    glutDisplayFunc(mydisplay);
    glutMainLoop();
}
